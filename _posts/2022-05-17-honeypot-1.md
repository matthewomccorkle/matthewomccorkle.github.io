---
title:  "NAHB-A : Not Another Honeypot Blog - AWS Version"
excerpt: "This post is about running a T-Pot Honeypot in AWS"
mathjax: true
layout: post
categories:
    -- github
    -- website

---

![Honey](https://raw.githubusercontent.com/matthewomccorkle/matthewomccorkle.github.io/master/_posts/assets/honey.jpg)

## Hello and welcome to the NAHB - A blog post.

## This blog is designed to give some background information on honeypots, how to setup the T-Pot, and the results of running T-Pot for 7 days.

I created this blog to help you the reader understand the following:

[What is a honeypot?]()

[What did I use my honeypot for?]()

[What limitations did my honeypot have?]()

[What honepot setup did I use?]()

- [[Connected honeypots]]()

[What technologies / services I used]

[How to setup a honeypot]

[Expected outcomes]

[Actual outcomes]

[Analysis of logs]

- [Top 3 IP Addresses]
- [Top 5 Countries of Origin]
- [Top 10 Passwords]
- [Top 3 Commands]

[Most interesting findings]

- [Commands]
- [Attack Type]
- [Unexpected]
- [Something I learned and was not aware of prior to setting up the Honeypot]

[Mitigating vulnerabilities]

[What I would do differently next time]

[Summary]

# What is a honeypot?

According to Merriam-Webster a honeypot is *"one that is attractive or desirable"*<sub>[1](https://www.merriam-webster.com/dictionary/honeypot)</sub>

In the information security realm, a honeypot is defined by the function it is used for. 

Wikipedia describes a Honeypot as *"a computer security mechanism set to detect, deflect, or, in some manner, counteract attempts at unauthorized use of information systems."*<sub>[2](https://en.wikipedia.org/wiki/Honeypot_(computing)#:~:text=a%20computer%20security%20mechanism%20set%20to%20detect%2C%20deflect%2C%20or%2C%20in%20some%20manner%2C%20counteract%20attempts%20at%20unauthorized%20use%20of%20information%20systems.)</sub>

**tldr:** Generally a honeypot is a vulnerable system with a wide attack surface that attracts attackers, logs their activities and displays the informaation in a log format. 

# What did I use my honeypot for?

My honeypot ran for **XX** days with a public facing IP address, with ports 1-64000 open. **Note**: Not all ports had services running. 

My intention was to gather as much intel as possible on attackers techniques and then analyze that data to determine the following:

- Top 10 ports tested for vulnerabilities.

- Top 10 commands used by attackers.

- Top 10 passwords used by attackers.

- Top 10 countries of origin.

# What honeypot setup did I use?

I built my honeypot on an Amazon Web Services EC2 Debian 11 server using a t3.xlarge instance. 

Using AWS was the quick and convenient method for running the honeypot because of:

- Ease spinning up services in AWS.

- Ease of networking in AWS.
  
  - Obtaining an elastic IP address and having it connected to your instance is quick and effortless.

- Ease of security groups in AWS.

- No hardware requirements.

Reasons AWS might not be right for you:

1. ~$10/day this can get costly.

2. Provisioning of resources manually.

#### Minimum Requirements for T-Pot

Minimum suggested requirements for running T-Pot can be found [here]([GitHub - telekom-security/tpotce: üçØ T-Pot - The All In One Honeypot Platform üêù](https://github.com/telekom-security/tpotce#system-requirements).

#### Honeypots included in T-Pot:

All information for ports and honeypots can be found [here](https://github.com/telekom-security/tpotce#technical-concept).

# Services & Technologies used

- Amazon Web Services (EC2)

- SSH

- Elastic Stack - For searching through logs of attacks and displaying the data nicely.

- ElasticVue - For browsing and interacting with an Elastic Search cluster.

- Honeypots - 22 various Honeypots.

# How to setup T-Pot

# Expected outcomes before running honeypot

I expect a lot of the attacks and probes of ports will be automated from bots. 

I expect to see CVE's of all types. 

# Analysis of logs

- Top 10 ports used by attackers.

- Top 10 commands used by attackers.

- Top 10 passwords used by attackers.

- Top 10 countries of origin.

# Unexpected outcomes

I was browsing through hex that was passed as payload data and decoding via [Cyberchef](https://gchq.github.io/CyberChef/). At this point in my analysis of the logs I had processed about 60+ different hex payloads. 

This one stood out to me in Cyberchef as it had something that I had not seen yet in previous hex decodes I performed: `fox a 1 -1 fox hello`. 

A quick google of `fox a 1 -1 fox hello` and I find it is a NMAP script which is also on Github [here](https://github.com/nmap/nmap/blob/master/scripts/fox-info.nse). Awesome! I love using NMAP and have tried remembering all of the different scripts and their uses, but alas this one I had not used. 

**HOWEVER**, what was most unexpected of this find was that this script was designed by the author "*based off Billy Rios and Terry **McCorkle's** work.*" Yes you read that correctly. 

Honestly, this gave me a chill down my spine. If you have ever seen "[The Truman Show (1998) - IMDb](https://www.imdb.com/title/tt0120382/))" then you know I felt immediately like I was living inside of an alternate reality. 

What are the odds of finding my last name in a random honeypot hex attack payload? I am sure one of you data scientists or math experts could tell me the odds, but I believe the odds must be extremely low, nearly unlikely. 



# Mitigating the vulnerabilities through system hardening

# What did I learn?

# What would I do differently next time?

# Summary

# Sources:

1. [Honeypot Definition & Meaning - Merriam-Webster](https://www.merriam-webster.com/dictionary/honeypot).

2. [Honeypot (computing) - Wikipedia](https://en.wikipedia.org/wiki/Honeypot_(computing)#:~:text=a%20computer%20security%20mechanism%20set%20to%20detect%2C%20deflect%2C%20or%2C%20in%20some%20manner%2C%20counteract%20attempts%20at%20unauthorized%20use%20of%20information%20systems).

3. 
